(window.webpackJsonpstravakongen=window.webpackJsonpstravakongen||[]).push([[0],{117:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(22),o=n.n(c),s=(n(69),n(52)),u=n(5),l=n(30),i=n.n(l),m=n(8),d="https://www.strava.com/api/v3/",f=function(e,t){return i.a.request(t,{params:{access_token:e}})},_=function(e,t,n){return"".concat(e,"&").concat(t,"=").concat(n)},g=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d+t.join("/")+"?"},b=function(e,t){return _(function(e,t){return _(g("segments",t,"leaderboard"),"club_id",e)}(e,t),"per_page",50)},p=n(29),y=597247,k={all:b,year:function(e,t){return _(b(e,t),"date_range","this_year")}},h=function(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(null),s=Object(u.a)(o,2),l=s[0],i=s[1],d=e.segmentId,_=e.club||y,b=Object(m.e)((function(e){return e.accessToken}));return Object(a.useEffect)((function(){if(b){var t=(0,k[e.dateRange])(_,d);f(b,t).then((function(t){i({id:d,dateRange:e.dateRange,leaderboard:t.data.entries})}))}}),[d,e.dateRange,_,b]),Object(m.d)((function(e){return e.addLeaderboard}))(l),Object(a.useEffect)((function(){if(b){var e=g("segments",d);f(b,e).then((function(e){c(e.data)}))}}),[d,b]),Object(m.d)((function(e){return e.addSegment}))(r),null},v=n(56),E=n(63),j=n(18),O=n(26),w=n(55),N=function(e){var t=e.map((function(e,t){return Object(j.a)({},e,{rankPos:t})})),n=Object.values(Object(w.groupBy)(t,(function(e){return e.ranks})));return n.flatMap((function(e){return e.map((t=e[0].rankPos,function(e){return Object(j.a)({},e,{rankPos:t})}));var t}))},S=function(e,t,n){var a=function(e){return n[e].length+1},r=Array.from(t.filter((function(e){return n[e]}))),c=Object.entries(e).map((function(e,t){var n=Object(u.a)(e,2),c=n[0],o=n[1];return{athleteName:c,ranks:r.map((function(e){return t=o[e],n=e,t?t.rank:a(n);var t,n}))}})),o=O.b(O.a(O.c,"ranks"),(function(e){return e.reduce((function(e,t){return e+t}),0)}),c),s=Object.entries(o).map((function(e){var t=Object(u.a)(e,2);t[0];return t[1]})),l=Object(E.a)(s).sort((function(e,t){return e.ranks-t.ranks})),i=r.map((function(e){return a(e)})).reduce((function(e,t){return e+t}),0),m=l.filter((function(e){return e.ranks!==i}));return N(m)},x=n(4),L=n.n(x),I=(n(97),function(e){return r.a.createElement("td",null,"  ")}),R=function(e){e.athlete_name;var t=e.elapsed_time,n=e.start_date_local,a=e.rank,c=e.clicked,o=n.substr(0,10).split("-").reverse().join("."),s=function(e){var t=parseInt(e,10),n=new Date(null);return n.setSeconds(t),n.getHours()>1?n.toISOString().substr(11,8):n.toISOString().substr(14,5)}(t),u="".concat(s," (#").concat(a,")"),l={1:L.a.entry_first,2:L.a.entry_second,3:L.a.entry_third}[a]||L.a.entry_normal,i=function(e){var t=Math.abs(new Date-new Date(e));return Math.ceil(t/864e5)<7}(n)?" ".concat(L.a.entry_border):"";return r.a.createElement("td",{className:l+i},u," ",r.a.createElement("span",null,c&&o))},A=function(e){var t=r.a.useState(!1),n=Object(u.a)(t,2),a=n[0],c=n[1],o=Object(u.a)(e.args,5),s=o[0],l=o[1],i=o[2],m=o[3],d=o[4];return r.a.createElement("tr",{onClick:function(){return c(!a)}},r.a.createElement("td",null,r.a.createElement("b",null,s)," ",0===d&&"\ud83e\udd47",1===d&&"\ud83e\udd48",2===d&&"\ud83e\udd49"),r.a.createElement("td",{className:L.a.ranktext_header},r.a.createElement("span",{className:L.a.ranktext_rank},d+1),r.a.createElement("span",{className:L.a.ranktext_score}," (".concat(l,")"))),Array.from(m).map((function(e,t){return function(e,t,n){var a=Object(j.a)({},e,{clicked:t});return e?r.a.createElement(R,Object.assign({key:n},a)):r.a.createElement(I,{key:n})}(i[e],a,t)})))},G=function(e){var t=e.segmentId,n=e.segmentName,a=e.realSegmentName,c=e.numAthletes,o=e.distance,s=e.averageGrade,u=e.clicked,l=Math.round(o/1e3*10)/10+"km",i=s,m="".concat(a," - ").concat(l," ").concat(i,"% (").concat(c,")");return r.a.createElement("a",{className:L.a.header,href:"https://www.strava.com/segments/"+t},u&&m?m:n)},P=function(e){var t=e.child;return r.a.createElement("th",{className:L.a.header},t," ")},T=function(e){var t=e.segmentRowMapper,n=r.a.useState(!1),a=Object(u.a)(n,2),c=a[0],o=a[1];return r.a.createElement("tr",{onClick:function(){return o(!c)}},r.a.createElement(P,{child:"Navn"}),r.a.createElement(P,{child:"# (Poeng)"}),t(c).map((function(e){return r.a.createElement(P,{key:e.props.segmentId,child:e})})))},C={2462560:{id:2462560,name:"Sognsvann rundt medsols",groups:{"L\xf8pekongen":1}},2783427:{id:2783427,name:"Sognsvann rundt motsols",groups:{"L\xf8pekongen":1}},1557103:{id:1557103,name:"Vettakollen opp langs eggen 2",groups:{"L\xf8pekongen":1}},5891167:{id:5891167,name:"Sognsvann-Ullev\xe5lseter",groups:{"L\xf8pekongen":1}}},M={"L\xf8pekongen":"\ud83c\udfc3\ud83c\udffb\u200d\u2642\ufe0f"},B=Object.keys(M),q=function(e){var t=e.segments,n=e.dateRange,a=Object(m.e)((function(e){return e})),c=a.segments,o=a.athleteEfforts[n],s=a.segmentLeaderboards[n],u=S(o,t,s).map((function(e,n){var a=e.athleteName,c=e.ranks,s=e.rankPos;return r.a.createElement(A,{key:a,args:[a,c,o[a],t,s]})}));return r.a.createElement(v.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement(T,{segmentRowMapper:function(e){return t.map((function(t){var n=s[t]?s[t].length:"",a=(c[t]&&c[t].name,C[t]&&C[t].name),o=c[t]&&c[t].name;return r.a.createElement(G,{key:t,segmentId:t,numAthletes:n,segmentName:a,realSegmentName:o,distance:c[t]&&c[t].distance,averageGrade:c[t]&&c[t].average_grade,clicked:e})}))}})),r.a.createElement("tbody",null,u))},D=n(33),J=n(14),W={all:"Gjennom alle tider",year:"I \xe5r"},H=function(e){var t=e.match.params.segmentGroup,n=B[0],a=M[t]?t:n,c=r.a.useState("all"),o=Object(u.a)(c,2),l=o[0],f=o[1],_=r.a.useState(a),g=Object(u.a)(_,2),b=g[0],y=g[1],k=p.parse(e.location.search);!function(){var e=r.a.useState(null),t=Object(u.a)(e,2),n=t[0],a=t[1];r.a.useEffect((function(){i.a.post(d+"oauth/token",{client_id:"44718",grant_type:"refresh_token",client_secret:"e5db1086bcc8b0c037fe6eda6367081c4c8fba8f",refresh_token:"19852fa2742ef1f5802dc1c94223c6d7fe7cf980"}).then((function(e){a(e.data.access_token)})).catch((function(e){return console.log(e)}))}),[]),Object(m.d)((function(e){return e.addAccessToken}))(n)}();var v=[];try{var E=JSON.parse(k.segments);v=E.some(isNaN)?[]:E}catch(A){}var j=Object.values(C).filter((function(e){return e.groups[b]})).map((function(e){return e.id})),O=v.length>0?v:j,w=Object.entries(W).map((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return r.a.createElement(J.a.Item,{key:n,className:L.a.dropdown_item,onClick:function(e){return f(n)}},a)})),N=function(e){return e.map((function(e){return r.a.createElement(J.a.Item,{key:e,className:L.a.dropdown_item,onClick:function(){return y(e)}},e+" "+M[e])}))},S=Object.keys(M),x=Object(s.a)(S),I=x[0],R=x.slice(1);return r.a.createElement("div",null,r.a.createElement("div",{className:L.a.button_row},r.a.createElement(D.a,{className:L.a.button,title:"Segmentgruppe : "+b+" "+M[b]},N([I]),r.a.createElement(J.a,{className:L.a.divider}),N(R)),r.a.createElement(D.a,{className:L.a.button,title:"Periode : "+W[l]},w)),r.a.createElement(q,{segments:O,dateRange:l}),O.map((function(e,t){return r.a.createElement(h,{key:t,club:k.club,dateRange:l,segmentId:e})})))},Q=n(60),V=n(15),Z=Object(m.c)({accessToken:null,athleteEfforts:{all:{},year:{}},segmentLeaderboards:{all:{},year:{}},segments:{},addAccessToken:Object(m.b)((function(e,t){t&&(e.accessToken=t)})),addSegment:Object(m.b)((function(e,t){if(t){var n=t.name,a=t.distance,r=t.average_grade;e.segments[t.id]={name:n,distance:a,average_grade:r}}})),addLeaderboard:Object(m.b)((function(e,t){if(t){var n=t.id;e.segmentLeaderboards[t.dateRange][n]=t.leaderboard;t.leaderboard.forEach((function(a){a.segment=n;var r=e.athleteEfforts[t.dateRange][a.athlete_name]||{};r[a.segment]=a,e.athleteEfforts[t.dateRange][a.athlete_name]=r}))}}))}),F=function(){return function(){var e=document.querySelector('meta[name="viewport"]');e&&(e.content="initial-scale=1",e.content="width=device-width")}(),r.a.createElement(m.a,{store:Z},r.a.createElement(Q.a,null,r.a.createElement(V.c,null,r.a.createElement(V.a,{path:"/:segmentGroup",component:H}),r.a.createElement(V.a,{path:"/",component:H}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},4:function(e,t,n){e.exports={entry_first:"mystyle_entry_first__GZGLw",entry_second:"mystyle_entry_second__13TpZ",entry_third:"mystyle_entry_third__3fLIV",entry_normal:"mystyle_entry_normal__34dj6",button_row:"mystyle_button_row__17d_B",button:"mystyle_button__1ALQQ",ranktext_td:"mystyle_ranktext_td__1tHWr",ranktext_rank:"mystyle_ranktext_rank__2OPnq",ranktext_score:"mystyle_ranktext_score__1CaNx",header:"mystyle_header__1abc1",th:"mystyle_th__1KFdi",score:"mystyle_score__3Csax",divider:"mystyle_divider__1Tx-L",entry_border:"mystyle_entry_border__1ohS_"}},64:function(e,t,n){e.exports=n(117)},69:function(e,t,n){}},[[64,1,2]]]);
//# sourceMappingURL=main.9b76b463.chunk.js.map